<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hospital Dashboard ‚Äî 3D + Billing</title>
  <style>
    /* ---------------------------
       Basic reset & layout
       --------------------------- */
    :root{
      --bg:#0f1724;
      --card:#0b1320;
      --muted:#9aa4b2;
      --accent:#6ee7b7;
      --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(255,255,255,0.02);
      --card-radius: 14px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071022 0%, #071827 60%);color:#e6eef6}
    .app {
      display:grid;
      grid-template-columns: 320px 1fr 420px;
      grid-template-rows: 72px 1fr;
      gap:18px;
      height:100vh;
      padding:18px;
      align-items:start;
    }

    header {
      grid-column:1/-1;
      height:72px;
      display:flex;
      align-items:center;
      gap:18px;
      padding:12px 18px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
      backdrop-filter: blur(6px);
    }
    .logo {
      display:flex;align-items:center;gap:12px;
      font-weight:700;font-size:18px;
    }
    .logo .dot {width:12px;height:12px;border-radius:3px;background:var(--accent);box-shadow:0 0 12px rgba(110,231,183,0.15)}
    .search {
      margin-left:auto;
      background:var(--glass);
      border-radius:10px;padding:8px 12px;color:var(--muted);
      display:flex;gap:8px;align-items:center;
    }
    .search input{background:transparent;border:0;outline:0;color:inherit;width:240px}

    /* ---------------------------
       Sidebar
       --------------------------- */
    .sidebar {
      grid-row:2/3;
      background:var(--card);
      padding:18px;
      border-radius:var(--card-radius);
      box-shadow: 0 8px 20px rgba(2,6,23,0.6);
      height:calc(100vh - 126px);
      overflow:auto;
    }
    .nav-item {
      display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;color:var(--muted);cursor:pointer;
    }
    .nav-item:hover{background:var(--glass-2);color:#e6eef6}

    /* ---------------------------
       Main content (3D + charts)
       --------------------------- */
    .main {
      grid-row:2/3;
      padding:18px;
      background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border-radius:var(--card-radius);
      box-shadow: 0 8px 20px rgba(2,6,23,0.6);
      overflow:hidden;
      position:relative;
    }
    .top-cards {display:flex;gap:14px;margin-bottom:16px}
    .card {
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));
      border-radius:12px;padding:14px;flex:1;
      min-height:86px;
    }
    .card h4{margin:0 0 6px 0;font-size:13px;color:var(--muted)}
    .card p{margin:0;font-size:20px;font-weight:700}

    .three-wrap {
      display:flex;gap:18px;
      align-items:stretch;
    }
    /* 3D canvas left */
    .three-card{
      width:65%;
      min-height:420px;
      border-radius:12px;
      overflow:hidden;
      position:relative;
      display:flex;flex-direction:column;
    }
    #three-canvas {width:100%;height:100%;display:block;background:linear-gradient(180deg,#06101a,#071827);}

    /* right column: chart and billing */
    .right {
      grid-row:2/3;
      padding:18px;
      background:var(--card);
      border-radius:var(--card-radius);
      box-shadow: 0 8px 20px rgba(2,6,23,0.6);
      height:calc(100vh - 126px);
      overflow:auto;
    }

    .chart-wrap{height:220px;padding:6px;background:var(--glass);border-radius:10px;margin-bottom:14px}

    /* Billing form */
    .bill {
      background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      padding:12px;border-radius:12px;
    }
    label{display:block;font-size:12px;color:var(--muted);margin-top:10px}
    input[type="text"], input[type="number"], select {
      width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);
      background:transparent;color:inherit;margin-top:6px;
    }
    .btn {
      display:inline-block;margin-top:12px;padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#4fd9a1);
      color:#012018;font-weight:700;border:0;cursor:pointer;box-shadow:0 6px 18px rgba(14,168,124,0.12);
    }

    .receipt {
      margin-top:12px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);font-size:13px;color:var(--muted)
    }

    /* responsive */
    @media (max-width:1100px){
      .app{grid-template-columns:1fr;grid-template-rows:72px 1fr 1fr}
      .sidebar{height:auto}
      .right{height:auto}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo"><div class="dot"></div> HospDash</div>
      <div style="font-size:13px;color:var(--muted)">Admin Dashboard</div>
      <div class="search" title="Quick search"><svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#9aa4b2" stroke-width="1.6" stroke-linecap="round"></path><circle cx="11" cy="11" r="6" stroke="#9aa4b2" stroke-width="1.6"></circle></svg><input placeholder="Search patients, bills..." /></div>
    </header>

    <aside class="sidebar">
      <div style="font-weight:700;margin-bottom:12px">Navigation</div>
      <div class="nav-item">üè† Overview</div>
      <div class="nav-item">üßæ Bills & Payments</div>
      <div class="nav-item">üë©‚Äç‚öïÔ∏è Patients</div>
      <div class="nav-item">üìä Analytics</div>
      <div class="nav-item">‚öôÔ∏è Settings</div>

      <div style="margin-top:18px;font-weight:700;color:var(--muted);font-size:13px">Quick stats</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px">
        <div style="background:var(--glass);padding:10px;border-radius:8px">
          <div style="font-size:12px;color:var(--muted)">Today's Visits</div>
          <div style="font-weight:700">128</div>
        </div>
        <div style="background:var(--glass);padding:10px;border-radius:8px">
          <div style="font-size:12px;color:var(--muted)">Pending Bills</div>
          <div style="font-weight:700">22</div>
        </div>
        <div style="background:var(--glass);padding:10px;border-radius:8px">
          <div style="font-size:12px;color:var(--muted)">Revenue</div>
          <div style="font-weight:700">‚Çπ1.2L</div>
        </div>
        <div style="background:var(--glass);padding:10px;border-radius:8px">
          <div style="font-size:12px;color:var(--muted)">Beds Free</div>
          <div style="font-weight:700">34</div>
        </div>
      </div>
    </aside>

    <main class="main">
      <div class="top-cards">
        <div class="card">
          <h4>Active Patients</h4>
          <p>532</p>
        </div>
        <div class="card">
          <h4>Today's Income</h4>
          <p>‚Çπ23,840</p>
        </div>
        <div class="card">
          <h4>Payments Processed</h4>
          <p>48</p>
        </div>
      </div>

      <div class="three-wrap">
        <div class="three-card card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div>
              <div style="font-size:13px;color:var(--muted)">3D Hospital View</div>
              <div style="font-weight:700">Animated Model</div>
            </div>
            <div style="font-size:12px;color:var(--muted)">Status: <span id="scene-status" style="color:#8fdabf">running</span></div>
          </div>
          <canvas id="three-canvas"></canvas>
        </div>

        <div style="flex:1;display:flex;flex-direction:column;gap:12px">
          <div class="card chart-wrap">
            <canvas id="occupancyChart"></canvas>
          </div>

          <div class="card" style="padding:14px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-size:13px;color:var(--muted)">Recent Payments</div>
                <div style="font-weight:700">Last 7 days</div>
              </div>
              <div style="font-size:12px;color:var(--muted)">Total: ‚Çπ54,640</div>
            </div>

            <ul id="recent-list" style="margin-top:12px;padding:0;list-style:none;color:var(--muted)">
              <li style="padding:8px 0;border-bottom:1px dashed rgba(255,255,255,0.02)">Rhea Sharma ‚Äî ‚Çπ4,820</li>
              <li style="padding:8px 0;border-bottom:1px dashed rgba(255,255,255,0.02)">Amit Roy ‚Äî ‚Çπ2,120</li>
              <li style="padding:8px 0;border-bottom:1px dashed rgba(255,255,255,0.02)">Kiran ‚Äî ‚Çπ18,400</li>
            </ul>
          </div>
        </div>
      </div>
    </main>

    <aside class="right">
      <div style="font-weight:700;margin-bottom:12px">Pay Hospital Bill</div>

      <div class="bill">
        <label>Patient Name</label>
        <input id="patientName" type="text" placeholder="e.g., Rajesh Kumar" value="">

        <label>Patient ID</label>
        <input id="patientId" type="text" placeholder="e.g., HOSP-00021">

        <label>Department</label>
        <select id="dept">
          <option>General</option>
          <option>Cardiology</option>
          <option>Orthopedics</option>
          <option>Neurology</option>
          <option>Emergency</option>
        </select>

        <label>Amount (‚Çπ)</label>
        <input id="amount" type="number" placeholder="1200" min="1">

        <label>Payment Method</label>
        <select id="payMethod">
          <option value="mock">Mock (Demo)</option>
          <option value="stripe">Stripe (placeholder)</option>
          <option value="razorpay">Razorpay (placeholder)</option>
        </select>

        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn" id="payBtn">Pay Now</button>
          <button class="btn" id="quick50" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Quick ‚Çπ50</button>
        </div>

        <div class="receipt" id="receipt" style="display:none"></div>

        <div style="font-size:12px;color:var(--muted);margin-top:8px">
          Note: This demo simulates payment. To integrate a real gateway (Stripe/Razorpay) replace the `processPayment` mock with your provider's SDK/server call.
        </div>
      </div>

      <div style="margin-top:18px">
        <div style="font-weight:700;margin-bottom:8px">Recent Transactions</div>
        <div style="background:var(--glass);padding:12px;border-radius:10px">
          <div style="display:flex;justify-content:space-between"><div style="color:var(--muted)">#TXN9821</div><div>‚Çπ4,820</div></div>
          <div style="display:flex;justify-content:space-between;margin-top:8px"><div style="color:var(--muted)">#TXN9820</div><div>‚Çπ2,120</div></div>
        </div>
      </div>
    </aside>
  </div>

  <!-- CDN scripts -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <script>
    /*******************************
     * 3D Scene ‚Äî three.js simple animated hospital block
     *******************************/
    (function init3D(){
      const canvas = document.getElementById('three-canvas');
      const renderer = new THREE.WebGLRenderer({canvas, antialias:true, alpha:true});
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(canvas.clientWidth || 800, canvas.clientHeight || 420, false);
      const scene = new THREE.Scene();

      const camera = new THREE.PerspectiveCamera(35, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
      camera.position.set(4,3.2,6);

      // lights
      const hemi = new THREE.HemisphereLight(0xffffff, 0x222233, 0.7);
      scene.add(hemi);
      const dir = new THREE.DirectionalLight(0xffffff, 0.8);
      dir.position.set(5,10,7);
      scene.add(dir);

      // ground plane
      const groundMat = new THREE.MeshStandardMaterial({color:0x071827, metalness:0.1, roughness:0.8});
      const plane = new THREE.Mesh(new THREE.PlaneGeometry(200,200), groundMat);
      plane.rotation.x = -Math.PI/2;
      plane.position.y = -1.0;
      scene.add(plane);

      // hospital main building (a stack of boxes)
      const buildingGroup = new THREE.Group();
      function makeBlock(w,h,d,y, color){
        const g = new THREE.BoxGeometry(w,h,d);
        const m = new THREE.MeshStandardMaterial({color, metalness:0.2, roughness:0.4});
        const mesh = new THREE.Mesh(g,m);
        mesh.position.y = y;
        return mesh;
      }
      const base = makeBlock(3.4,1.0,2.0,0.0, 0x0d5f8b);
      const mid = makeBlock(2.6,1.6,1.6,1.1, 0x1273a6);
      const top = makeBlock(1.6,1.0,1.0,2.2, 0x58b0d0);
      base.receiveShadow = mid.castShadow = top.castShadow = true;
      buildingGroup.add(base, mid, top);

      // windows (simple emissive squares)
      const winMat = new THREE.MeshStandardMaterial({color:0x111111, emissive:0xfff2cc, emissiveIntensity:0.08});
      for(let i=-1;i<=1;i++){
        const w = new THREE.Mesh(new THREE.BoxGeometry(0.35,0.2,0.02), winMat);
        w.position.set(-1.3 + i*0.9, 1.1, 0.81);
        buildingGroup.add(w);
      }
      // cross sign on top
      const crossMat = new THREE.MeshStandardMaterial({color:0xfff2f0, metalness:0.5});
      const cross1 = new THREE.BoxGeometry(0.5,0.12,0.12);
      const cross2 = new THREE.BoxGeometry(0.12,0.5,0.12);
      const mesh1 = new THREE.Mesh(cross1, crossMat); mesh1.position.set(0,3.0,0);
      const mesh2 = new THREE.Mesh(cross2, crossMat); mesh2.position.set(0,3.0,0);
      buildingGroup.add(mesh1, mesh2);

      buildingGroup.position.set(0,0.2,0);
      scene.add(buildingGroup);

      // subtle environment fog
      scene.fog = new THREE.FogExp2(0x071827, 0.025);

      // resize handler
      function onResize(){
        const w = canvas.clientWidth || canvas.parentElement.clientWidth;
        const h = canvas.clientHeight || 420;
        renderer.setSize(w, h, false);
        camera.aspect = w / h;
        camera.updateProjectionMatrix();
      }
      window.addEventListener('resize', onResize);

      // simple animation loop
      let last = 0;
      function animate(t){
        t *= 0.001;
        const dt = t - last;
        last = t;
        buildingGroup.rotation.y += 0.22 * dt; // gentle rotation
        // breathing scale animation
        const s = 1 + Math.sin(t*1.2)*0.02;
        buildingGroup.scale.set(s,s,s);

        renderer.render(scene, camera);
        requestAnimationFrame(animate);
      }
      onResize();
      animate(0);

      // expose minor controls status
      document.getElementById('scene-status').textContent = 'running';
    })();

    /*******************************
     * Chart: Occupancy (Chart.js)
     *******************************/
    (function makeChart(){
      const ctx = document.getElementById('occupancyChart').getContext('2d');
      const data = {
        labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
        datasets: [
          {label:'Occupancy %', data:[72,75,78,74,80,85,82], tension:0.4, fill:true}
        ]
      };
      const chart = new Chart(ctx, {
        type:'line',
        data,
        options:{
          plugins:{legend:{display:false}},
          scales:{
            y:{beginAtZero:true, max:100, ticks:{stepSize:20}},
            x:{grid:{display:false}}
          },
          maintainAspectRatio:false
        }
      });
      // make chart globally accessible for future updates
      window.occupancyChart = chart;
    })();

    /*******************************
     * Mock Payment Flow
     *******************************/
    (function paymentFlow(){
      const payBtn = document.getElementById('payBtn');
      const quick50 = document.getElementById('quick50');
      const receipt = document.getElementById('receipt');

      function generateTxnId() {
        return 'TXN' + Math.random().toString(36).slice(2,10).toUpperCase();
      }

      function showReceipt(data){
        receipt.style.display = 'block';
        receipt.innerHTML = `
          <div><strong>Receipt</strong></div>
          <div style="margin-top:6px"><strong>${data.patientName || 'Unknown'}</strong> (${data.patientId || '-'})</div>
          <div style="margin-top:6px;color:var(--muted)">Dept: ${data.dept}</div>
          <div style="margin-top:8px">Amount: ‚Çπ${data.amount}</div>
          <div style="margin-top:6px;color:var(--muted)">Method: ${data.method}</div>
          <div style="margin-top:6px;color:var(--muted)">Txn ID: ${data.txn}</div>
          <div style="margin-top:6px;font-size:12px;color:var(--muted)">Status: SUCCESS</div>
        `;
      }

      async function processPaymentMock({patientName, patientId, dept, amount, method}){
        // This is a simulated asynchronous "payment".
        // Replace this with real gateway SDK calls + server-side verification.
        return new Promise((resolve) => {
          const txn = generateTxnId();
          setTimeout(()=> resolve({success:true, txn}), 900);
        });
      }

      payBtn.addEventListener('click', async ()=>{
        const patientName = document.getElementById('patientName').value.trim();
        const patientId = document.getElementById('patientId').value.trim();
        const dept = document.getElementById('dept').value;
        const amount = Number(document.getElementById('amount').value);
        const method = document.getElementById('payMethod').value;

        if(!amount || amount<=0){
          alert('Please enter a valid amount.');
          return;
        }
        payBtn.disabled = true;
        payBtn.textContent = 'Processing...';

        if(method === 'mock'){
          const res = await processPaymentMock({patientName, patientId, dept, amount, method});
          if(res.success){
            showReceipt({patientName, patientId, dept, amount, method:'Mock', txn:res.txn});
            // update recent list + chart sample (local UI only)
            const list = document.getElementById('recent-list');
            const li = document.createElement('li');
            li.style.padding = '8px 0';
            li.style.borderBottom = '1px dashed rgba(255,255,255,0.02)';
            li.textContent = (patientName || 'Guest') + ' ‚Äî ‚Çπ' + amount;
            list.insertBefore(li, list.firstChild);
            // animate chart dataset a bit (demo)
            const ch = window.occupancyChart;
            if(ch){
              ch.data.datasets[0].data.push(Math.min(95, Math.round((ch.data.datasets[0].data.slice(-1)[0] || 70) + Math.random()*4 -1)));
              ch.data.labels.push('Now');
              ch.update();
            }
          } else {
            alert('Payment failed in demo mode.');
          }
        } else {
          // Placeholder: show instructions to integrate real gateway
          alert('You selected a real gateway placeholder. Replace the mock processPaymentMock with your provider integration (server-side tokenization, SDK calls).');
        }

        payBtn.disabled = false;
        payBtn.textContent = 'Pay Now';
      });

      quick50.addEventListener('click', ()=>{
        document.getElementById('amount').value = 50;
      });
    })();

    /*******************************
     * Notes for real payment integration (client only)
     * - For Stripe: fetch PaymentIntent from your server, then use stripe.confirmCardPayment on client.
     * - For Razorpay: create an order server-side, then open Razorpay checkout with order_id.
     * Always keep secret keys on server and verify payments server-side.
     *******************************/
  </script>
</body>
</html>
